(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{106:function(e,t,n){e.exports=n(273)},129:function(e,t,n){},201:function(e,t,n){},203:function(e,t,n){},205:function(e,t,n){},209:function(e,t,n){},211:function(e,t,n){},213:function(e,t,n){},215:function(e,t,n){},256:function(e,t,n){},258:function(e,t,n){},260:function(e,t,n){},262:function(e,t,n){},264:function(e,t,n){},266:function(e,t,n){},273:function(e,t,n){"use strict";n.r(t);var a={};n.r(a),n.d(a,"goals",function(){return B}),n.d(a,"page",function(){return $}),n.d(a,"dialog",function(){return ve}),n.d(a,"notifications",function(){return Ve});var o=n(0),l=n.n(o),r=n(26),i=n.n(r),s=n(21),c=n.n(s),u=n(11);n(123),n(125),n(127),n(129);function d(e,t,n){for(var a=n(e).slice();a.length>0;){var o=a.shift();if(t(o))return o;a=a.concat(n(o))}return null}function m(e,t){return d({subgoals:e},function(e){return t===e.id},function(e){return e.subgoals})}function p(e){var t=[],n=e.slice();for(n.reverse();n.length>0;){var a=n.pop();t.push(a);var o=a.subgoals.slice();o.reverse(),n=n.concat(o)}return t}var g=n(19),f=n(63),h="manual",b="target",y="deadline",v=n(99),E=n.n(v);function C(e){if(e.color)return e.color;for(var t=E()(e.name),n=0,a=0;a<32;a++)n=(16*n+parseInt(t[a],16))%32;return"color-".concat(n)}function O(e){return 0===e.subgoals.length}function k(e){return!0===e.completed||!0===e.completedImplicit}function D(e){return!1!==e.daily}var j="subgoals/goals/CREATE_GOAL",N="subgoals/goals/ADD_SUBGOAL",I="subgoals/goals/MOVE_SUBGOAL",S="subgoals/goals/SET_GOAL_NAME",T="subgoals/goals/SET_GOAL_COLOR",w="subgoals/goals/TOGGLE_GOAL_COMPLETE",x="subgoals/goals/DELETE_GOAL",M="subgoals/goals/ADD_TO_DAILY",G="subgoals/goals/REMOVE_FROM_DAILY",A="subgoals/goals/REMOVE_LATEST_FROM_DAILY",R="subgoals/goals/SET_DAILY_TYPE",_="subgoals/goals/CONFIGURE_DAILY_TYPE",L="subgoal/goals/TOGGLE_GOAL_DAILY",P={goals:[{id:0,name:"Welcome",color:"color-1",subgoals:[{id:1,name:"All items in this list are 'subgoals'",completed:!1,daily:!1,subgoals:[]},{id:10,name:"Click on a subgoal to edit and view more information",completed:!1,daily:!1,subgoals:[]},{id:9,name:"Completing subgoals",completed:!1,daily:!1,subgoals:[{id:3,name:"Tap in the top-left of a subgoal to toggle whether it is completed",completed:!1,daily:!1,subgoals:[]},{id:4,name:"This is a completed subgoal",completed:!0,daily:!1,subgoals:[]},{id:5,name:"When all subgoals directly beneath another item are completed, the item is also considered completed",completed:!1,daily:!1,subgoals:[]},{id:6,name:"This subgoal has all its subgoals completed, and is therefore completed",completed:!1,daily:!1,subgoals:[{id:7,name:"Task 1",completed:!0,daily:!1,subgoals:[]},{id:8,name:"Task 2",completed:!0,daily:!1,subgoals:[]}]}]},{id:11,name:"Daily goals",completed:!1,daily:!1,subgoals:[{id:12,name:"Daily goals are goals that you intend to complete daily (or every few days)",completed:!1,daily:!1,subgoals:[]},{id:13,name:"Click/tap on a daily goal to see its entire history and change settings",completed:!1,daily:!1,subgoals:[]},{id:14,name:"This is a daily goal",completed:!1,daily:{type:h,typeConfig:null,history:[]},subgoals:[]}]},{id:15,name:"You can delete this goal from the main page",completed:!1,daily:!1,subgoals:[]}],completed:!1,daily:!1}],nextId:6};function F(e,t,n){var a=g(e);return n(m(a.goals,t)),a}function B(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:P,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case j:return function(e,t){var n=g(e);return n.goals.push({id:n.nextId,name:t.name,subgoals:[],completed:!1,daily:!1}),n.nextId++,n}(e,t);case N:return function(e,t){var n=g(e),a=m(n.goals,t.goalId);return null!=a&&(a.subgoals.push({id:n.nextId,name:t.name,subgoals:[],completed:!1,daily:!1,points:0}),n.nextId++),n}(e,t);case I:return function(e,t){if(!t.dst)return e;var n=g(e),a=m(n.goals,t.src.parentId),o=m(n.goals,t.dst.parentId),l=isNaN(t.dst.index)?o.subgoals.length:t.dst.index,r=a.subgoals.splice(t.src.index,1)[0];return o.subgoals.splice(l,0,r),n}(e,t);case S:return F(e,t.goalId,function(e){return e.name=t.name});case T:return F(e,t.goalId,function(e){return e.color=t.color});case w:return F(e,t.goalId,function(e){return e.completed=!e.completed});case x:return function(e,t){var n=g(e),a=n.goals.findIndex(function(e){return e.id===t.goalId});if(a>-1)return n.goals.splice(a,1),n;var o=d({subgoals:n.goals},function(e){return-1!==e.subgoals.findIndex(function(e){return e.id===t.goalId})},function(e){return e.subgoals});if(!o)return e;var l=o.subgoals.findIndex(function(e){return e.id===t.goalId});return o.subgoals.splice(l,1),n}(e,t);case M:return F(e,t.goalId,function(e){e.daily&&e.daily.history.push(t.timestamp)});case G:return F(e,t.goalId,function(e){if(e.daily){var n=e.daily.history.indexOf(t.timestamp);n>-1&&e.daily.history.splice(n,1)}});case A:return F(e,t.goalId,function(e){var n=new Date(t.timestamp),a=e.daily.history.map(function(e){return new Date(e)}).filter(function(e){return e.getFullYear()===n.getFullYear()&&e.getMonth()===n.getMonth()&&e.getDate()===n.getDate()}).sort(function(e,t){return e>t?1:e<t?-1:0}).reverse();if(a.length>0){var o=a[0].toISOString(),l=e.daily.history.indexOf(o);l>-1?e.daily.history.splice(l,1):console.warn("Inconsistency: could not find index of history timestamp")}});case R:return F(e,t.goalId,function(e){if(e.daily.type===t.newType)return e;switch(e.daily.type=t.newType,e.daily.type){case b:e.daily.typeConfig=10;break;case y:var n=new Date;n.setDate(n.getDate()+7),e.daily.typeConfig=n.toISOString();break;default:e.daily.typeConfig=null}});case _:return F(e,t.goalId,function(e){return e.daily.typeConfig=t.config});case L:return F(e,t.goalId,function(e){e.daily?e.daily=!1:e.daily={type:h,typeConfig:null,history:[]}});default:return e}}function Y(e,t){return{type:S,goalId:e,name:t}}function U(e){return{type:w,goalId:e}}function K(e){return{type:x,goalId:e}}function V(e,t){return{type:M,goalId:e,timestamp:t}}function W(e,t){return{type:A,goalId:e,timestamp:t}}var q=Object(f.a)([function(e){return e.goals.goals}],function(e){var t=g(e),n=function e(t){if(t.subgoals.length>0){t.completed=!1;var n=!0,a=!0,o=!1,l=void 0;try{for(var r,i=t.subgoals[Symbol.iterator]();!(a=(r=i.next()).done);a=!0){e(r.value)||(n=!1)}}catch(s){o=!0,l=s}finally{try{a||null==i.return||i.return()}finally{if(o)throw l}}return!!n&&(t.completedImplicit=!0,!0)}return t.completed},a=!0,o=!1,l=void 0;try{for(var r,i=t[Symbol.iterator]();!(a=(r=i.next()).done);a=!0){n(r.value)}}catch(s){o=!0,l=s}finally{try{a||null==i.return||i.return()}finally{if(o)throw l}}return t}),H=Object(f.a)([function(e){return e.goals.goals}],function(e){return p(e).filter(function(e){return function(e){return!(!D(e)||e.completed)}(e)})}),J=n(28),z=n(5),Q="subgoals/page/SET_SELECTED_GOAL",X="subgoals/page/GO_BACK",Z={selectedGoalId:null,history:[]};function $(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Z,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case Q:return Object(z.a)({},e,{selectedGoalId:t.goalId,history:[].concat(Object(J.a)(e.history),[e.selectedGoalId])});case X:return Object(z.a)({},e,{selectedGoalId:e.history.pop()});default:return e}}function ee(e){return{type:Q,goalId:e}}var te=n(6),ne=n(7),ae=n(9),oe=n(8),le=n(10),re=(n(201),function(e){function t(){return Object(te.a)(this,t),Object(ae.a)(this,Object(oe.a)(t).apply(this,arguments))}return Object(le.a)(t,e),Object(ne.a)(t,[{key:"render",value:function(){var e=this,t=this.props.onGoalClick,n=this.props.goals.map(function(n){return l.a.createElement(ie,{goal:n,key:n.id,onGoalClick:t,onChangeGoalColor:e.props.onChangeGoalColor,onChangeGoalName:e.props.onChangeGoalName,onDeleteGoal:e.props.onDeleteGoal})});return l.a.createElement("ul",{className:"goal-list"},n,l.a.createElement("li",{key:"dummy",onClick:this.props.onNewGoal,className:"goal-list__item dummy"},l.a.createElement("h3",null,l.a.createElement("i",{className:"fas fa-plus"})," Create new goal")))}}]),t}(o.Component)),ie=function(e){var t=e.goal,n=e.onGoalClick,a=e.onChangeGoalName,o=e.onChangeGoalColor,r=e.onDeleteGoal;return l.a.createElement("li",{key:t.id,onClick:function(){return n(t)},className:"goal-list__item bg-".concat(t.color||C(t))},l.a.createElement("h3",null,t.name),l.a.createElement("span",null,Math.floor(100*function e(t){return k(t)?1:0===t.subgoals.length?0:t.subgoals.reduce(function(t,n){return t+e(n)},0)/t.subgoals.length}(t)),"%"),l.a.createElement("div",{className:"button-group"},l.a.createElement("button",{onClick:function(e){e.stopPropagation(),a(t)}},l.a.createElement("i",{className:"fas fa-pen"})),l.a.createElement("button",{onClick:function(e){e.stopPropagation(),o(t)}},l.a.createElement("i",{className:"fas fa-palette"})),l.a.createElement("button",{onClick:function(e){e.stopPropagation(),r(t)}},l.a.createElement("i",{className:"fas fa-trash"}))))},se=re,ce="subgoals/dialog/OPEN_INFO_DIALOG",ue="subgoals/dialog/OPEN_CONFIRM_DIALOG",de="subgoals/dialog/OPEN_INPUT_DIALOG",me="subgoals/dialog/OPEN_COLORPICKER_DIALOG",pe="subgoals/dialog/CLOSE_DIALOG",ge="info",fe="input",he="colorpicker",be="confirm",ye={type:null,message:null,isOpen:!1,onAccept:null,onReject:null};function ve(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ye,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case ce:return Object(z.a)({},e,{type:ge,isOpen:!0,message:t.message});case ue:return Object(z.a)({},e,{type:be,isOpen:!0,message:t.message,onAccept:t.onAccept,onReject:t.onReject});case de:return Object(z.a)({},e,{type:fe,isOpen:!0,message:t.message,onAccept:t.onAccept,onReject:t.onReject,value:t.value});case me:return Object(z.a)({},e,{type:he,isOpen:!0,message:t.message,onAccept:t.onAccept,onReject:t.onReject,value:t.value});case pe:return Object(z.a)({},e,{isOpen:!1});default:return e}}function Ee(e,t,n){return{type:ue,message:e,onAccept:t,onReject:n}}function Ce(e,t,n){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"";return{type:de,message:e,onAccept:t,onReject:n,value:a}}function Oe(e){e(Ce("Enter goal name",function(t){e(function(e){return{type:j,name:e}}(t))},function(){}))}function ke(e,t){var n=t.id;e(function(e,t,n){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"color-0";return{type:me,message:e,onAccept:t,onReject:n,value:a}}("Choose colour",function(t){e(function(e,t){return{type:T,goalId:e,color:t}}(n,t))},function(){},C(t)))}var De=Object(u.b)(function(e){return{goals:q(e)}},function(e){return{onGoalClick:function(t){return e(ee(t.id))},onNewGoal:function(){return Oe(e)},onChangeGoalName:function(t){return function(e,t){var n=t.id;e(Ce("Enter goal name",function(t){e(Y(n,t))},function(){},t.name))}(e,t)},onChangeGoalColor:function(t){return ke(e,t)},onDeleteGoal:function(t){return function(e,t){var n=t.id;e(Ee("Are you sure you want to delete this goal? This action cannot be undone",function(){e(K(n))},function(){}))}(e,t)}}})(se),je=(n(203),function(e){function t(e){var n;Object(te.a)(this,t),(n=Object(ae.a)(this,Object(oe.a)(t).call(this,e))).state={days:[]};for(var a=new Date,o=0;o<7;o++)n.state.days.push(new Date(a)),a.setDate(a.getDate()-1);return n}return Object(le.a)(t,e),Object(ne.a)(t,[{key:"formatDate",value:function(e){return e.toLocaleString("default",{month:"2-digit",day:"2-digit"})}},{key:"isSameDay",value:function(e,t){return e.getFullYear()===t.getFullYear()&&e.getMonth()===t.getMonth()&&e.getDate()===t.getDate()}},{key:"isToday",value:function(e){var t=new Date;return this.isSameDay(t,e)}},{key:"getDayCounts",value:function(){for(var e=this,t={},n=this.props.goals.map(function(e){return e.daily.history.map(function(e){return new Date(e)})}),a=0;a<this.props.goals.length;a++){var o=this.props.goals[a].id;t[o]={};var l=!0,r=!1,i=void 0;try{for(var s,c=function(){var n=s.value,a=e.state.days.find(function(t){return e.isSameDay(t,n)});a&&(t[o][a]=(t[o][a]||0)+1)},u=n[a][Symbol.iterator]();!(l=(s=u.next()).done);l=!0)c()}catch(d){r=!0,i=d}finally{try{l||null==u.return||u.return()}finally{if(r)throw i}}}return t}},{key:"render",value:function(){var e=this;if(0===this.props.goals.length)return l.a.createElement("em",null,"You have no uncompleted daily goals");var t=this.state.days,n=this.getDayCounts();return l.a.createElement("div",null,l.a.createElement("div",{className:"daily-goal-list"},l.a.createElement("div",{className:"daily-goal-list__left"},l.a.createElement("span",{className:"spacer"}),this.props.goals.map(function(e){return l.a.createElement("label",{key:e.id},e.name)})),l.a.createElement("div",{className:"daily-goal-list__right"},l.a.createElement("span",{className:"spacer"},t.map(function(t){return l.a.createElement("span",{key:t,className:"day-label"},l.a.createElement("label",null,e.formatDate(t)))})),this.props.goals.map(function(a){return l.a.createElement("div",{className:"row",key:a.id},t.map(function(t){return l.a.createElement("button",{key:t+"-"+a.id,className:(e.isToday(t)?"today":"")+(n[a.id][t]?" completed":""),onClick:function(){return e.props.onMarkDay(a,t)},onContextMenu:function(n){n.preventDefault(),e.props.onUnmarkDay(a,t)}},n[a.id][t]?n[a.id][t]>1?l.a.createElement("span",null,n[a.id][t]):l.a.createElement("i",{className:"fas fa-check"}):l.a.createElement("span",null,"\xa0"))}))}))))}}]),t}(o.Component)),Ne=Object(u.b)(function(e){return{goals:H(e)}},function(e){return{onMarkDay:function(t,n){return e(V(t.id,n.toISOString()))},onUnmarkDay:function(t,n){return e(W(t.id,n.toISOString()))}}})(je),Ie=function(e){e.goals,e.setSelectedGoal;return l.a.createElement("div",null,l.a.createElement("h2",null,"Daily Goals"),l.a.createElement(Ne,null),l.a.createElement("h2",null,"Goals"),l.a.createElement(De,null))},Se=n(1),Te=n(276),we=(n(205),document.getElementById("menu-root")),xe=function(e){function t(e){var n;return Object(te.a)(this,t),(n=Object(ae.a)(this,Object(oe.a)(t).call(this,e))).el=document.createElement("div"),n.renderMenu=n.renderMenu.bind(Object(Se.a)(Object(Se.a)(n))),n.handleBlur=n.handleBlur.bind(Object(Se.a)(Object(Se.a)(n))),n}return Object(le.a)(t,e),Object(ne.a)(t,[{key:"componentDidMount",value:function(){we.appendChild(this.el)}},{key:"componentWillUnmount",value:function(){we.removeChild(this.el)}},{key:"handleBlur",value:function(e){if(this.menuRef){for(var t=e.relatedTarget,n=!1;t&&t.parentNode;)if((t=t.parentNode)===this.menuRef){n=!0;break}n||this.props.onCloseMenu()}}},{key:"render",value:function(){return i.a.createPortal(this.renderMenu(),this.el)}},{key:"renderMenu",value:function(){var e=this;if(!this.props.visible||!this.props.anchorRef.current)return null;var t,n=this.props.anchorRef.current.getBoundingClientRect();if(window.innerWidth<1100){var a=window.innerWidth-n.right;t={top:"".concat(n.top,"px"),right:"".concat(a,"px")}}else t={top:"".concat(n.top,"px"),left:"".concat(n.left,"px")};return this.props.visible&&l.a.createElement("div",{className:"overflow-menu ".concat(this.props.visible?"visible":""),style:t,tabIndex:"-1",ref:function(t){t&&t.focus(),e.menuRef=t},onBlur:this.handleBlur},l.a.createElement("ul",null,this.props.items.map(function(t){return l.a.createElement("li",{key:t.text},l.a.createElement("button",{onClick:(n=t.onClick,function(){n()&&e.props.onCloseMenu()})},t.text));var n})))}}]),t}(l.a.Component),Me=n(100),Ge=n.n(Me),Ae=(n(208),n(209),n(211),function(e){function t(e){var n;Object(te.a)(this,t),(n=Object(ae.a)(this,Object(oe.a)(t).call(this,e))).getCount=n.getCount.bind(Object(Se.a)(Object(Se.a)(n))),n.handleChangeMonth=n.handleChangeMonth.bind(Object(Se.a)(Object(Se.a)(n)));var a=new Date;return n.state={year:a.getFullYear(),month:a.getMonth()},n}return Object(le.a)(t,e),Object(ne.a)(t,[{key:"getCount",value:function(e){return this.props.data.history.map(function(e){return new Date(e)}).filter(function(t){return t.getFullYear()===e.getFullYear()&&t.getMonth()===e.getMonth()&&t.getDate()===e.getDate()}).length}},{key:"getCountClass",value:function(e,t){if(0===t)return"count-0";if(1===t)return 0===e?"count-0":"count-6";var n=Math.round(e/t*12);return"count-".concat(n)}},{key:"generateRows",value:function(e,t){var n=0,a=[],o=[],l=new Date(e,t);l.setDate(1);var r=(l.getDay()-1)%7;r<0&&(r+=7),l.setDate(l.getDate()-r);for(var i=0;i<42;i++){var s=this.getCount(l);o.push({date:new Date(l),count:s,isSelectedMonth:l.getMonth()===t}),s>n&&(n=s),7===o.length&&(a.push(o),o=[]),l.setDate(l.getDate()+1)}return{rows:a,maxCount:n}}},{key:"getMonthString",value:function(e,t){return new Date(e,t).toLocaleString("default",{month:"long",year:"numeric"})}},{key:"handleChangeMonth",value:function(e){var t=new Date(this.state.year,this.state.month);t.setMonth(t.getMonth()+e),this.setState(Object(z.a)({},this.state,{year:t.getFullYear(),month:t.getMonth()}))}},{key:"render",value:function(){var e=this,t=this.generateRows(this.state.year,this.state.month),n=t.rows,a=t.maxCount,o=this.getMonthString(this.state.year,this.state.month);return l.a.createElement("div",null,l.a.createElement("div",{className:"month-select"},l.a.createElement("button",{onClick:function(){return e.handleChangeMonth(-1)}},l.a.createElement("i",{className:"fas fa-angle-left"})),l.a.createElement("span",null,o),l.a.createElement("button",{onClick:function(){return e.handleChangeMonth(1)}},l.a.createElement("i",{className:"fas fa-angle-right"}))),l.a.createElement("table",{className:"daily-month"},l.a.createElement("thead",null,l.a.createElement("tr",null,l.a.createElement("th",null,"Mo"),l.a.createElement("th",null,"Tu"),l.a.createElement("th",null,"We"),l.a.createElement("th",null,"Th"),l.a.createElement("th",null,"Fr"),l.a.createElement("th",null,"Sa"),l.a.createElement("th",null,"Su"))),l.a.createElement("tbody",null,n.map(function(t,n){return l.a.createElement("tr",{key:"row-".concat(n)},t.map(function(t){return l.a.createElement("td",{key:t.date,className:e.getCountClass(t.count,a)+(t.isSelectedMonth?"":" disabled"),onClick:function(){return e.props.onMarkDay(t.date)},onContextMenu:function(n){n.preventDefault(),e.props.onUnmarkDay(t.date)}},t.date.getDate())}))}))))}}]),t}(o.Component)),Re=function(e){function t(e){var n;return Object(te.a)(this,t),(n=Object(ae.a)(this,Object(oe.a)(t).call(this,e))).handleInputTitle=n.handleInputTitle.bind(Object(Se.a)(Object(Se.a)(n))),n.handleViewChildren=n.handleViewChildren.bind(Object(Se.a)(Object(Se.a)(n))),n.titleRef=l.a.createRef(),n}return Object(le.a)(t,e),Object(ne.a)(t,[{key:"handlePasteAsPlainText",value:function(e){e.preventDefault();var t=e.clipboardData.getData("text/plain");document.execCommand("insertHTML",!1,t)}},{key:"handleInputTitle",value:function(e){var t=this.titleRef.current.textContent;t!==this.props.subgoal.name&&this.props.onChangeTitle(this.props.subgoal,t)}},{key:"handleViewChildren",value:function(){this.props.onRequestClose(),this.props.onViewChildren(this.props.subgoal)}},{key:"renderProgress",value:function(){var e=this.props.subgoal;if(O(e))return l.a.createElement("p",null,l.a.createElement("i",{className:"progress-indicator fas fa-".concat(e.completed?"check":"times")}),e.completed?"Completed":"Incomplete");var t=e.subgoals.filter(function(e){return k(e)}).length,n=e.subgoals.length;return l.a.createElement("p",null,t," / ",n," subgoals completed")}},{key:"renderDaily",value:function(){var e=this.props.subgoal;return l.a.createElement(l.a.Fragment,null,l.a.createElement("h4",null,"Daily"),l.a.createElement("div",{className:"daily-controls"},this.renderDailyControls()),l.a.createElement(Ae,{data:e.daily,onMarkDay:this.props.onMarkDay.bind(null,e),onUnmarkDay:this.props.onUnmarkDay.bind(null,e)}))}},{key:"renderDailyControls",value:function(){var e,t=this,n=this.props.subgoal,a=n.daily;switch(a.type){case h:var o=a.history.length;e=l.a.createElement(l.a.Fragment,null,l.a.createElement("label",null,"Progress"),l.a.createElement("span",null,l.a.createElement("b",{className:"boxed-text"},o)," completions"));break;case b:var r=a.history.length/(a.typeConfig||1)*100;e=l.a.createElement(l.a.Fragment,null,l.a.createElement("label",{htmlFor:"target"},"Target"),l.a.createElement("span",null,l.a.createElement("input",{type:"number",name:"target",min:"1",value:a.typeConfig,onChange:function(e){return t.props.onConfigureDailyType(n,parseInt(e.target.value))}})),l.a.createElement("label",null,"Progress"),l.a.createElement("span",{className:"progress-bar"},l.a.createElement("div",{className:"progress-bar__bar"},l.a.createElement("span",{className:"fill",style:{width:Math.min(r,100)+"%"}})),l.a.createElement("span",{className:"progress-bar__label"},Math.floor(r),"%")));break;case y:var i=function(e,t){for(var n=e+"";n.length<t;)n="0"+n;return n},s=a.typeConfig?Math.ceil((new Date(a.typeConfig)-new Date)/864e5):"?";e=l.a.createElement(l.a.Fragment,null,l.a.createElement("label",{htmlFor:"deadline"},"Deadline"),l.a.createElement("span",null,l.a.createElement("input",{type:"date",name:"deadline",onChange:function(e){return t.props.onConfigureDailyType(n,(a=e.target.value)?new Date(a).toISOString():null);var a},value:function(e){if(!e)return"";var t=new Date(e);return i(t.getFullYear(),4)+"-"+i(t.getMonth()+1,2)+"-"+i(t.getDate(),2)}(a.typeConfig)})),l.a.createElement("label",null,"Progress"),l.a.createElement("span",null,l.a.createElement("b",{className:"boxed-text"},s)," days until deadline,\xa0",l.a.createElement("b",{className:"boxed-text"},a.history.length)," completions"));break;default:e=l.a.createElement(l.a.Fragment,null)}return l.a.createElement(l.a.Fragment,null,l.a.createElement("label",{htmlFor:"type"},"Type"),l.a.createElement("span",null,l.a.createElement("select",{name:"type",value:a.type,onChange:function(e){return t.props.onChangeDailyType(n,e.target.value)}},l.a.createElement("option",{value:h},"Manual"),l.a.createElement("option",{value:b},"Target"),l.a.createElement("option",{value:y},"Deadline"))),e)}},{key:"render",value:function(){var e=this,t=this.props.subgoal;return t?l.a.createElement("div",{className:"subgoal-modal-container"},l.a.createElement("header",null,l.a.createElement(Ge.a,{className:"editable",innerRef:this.titleRef,html:this.props.subgoal.name,disabled:!1,onChange:this.handleInputTitle,tagName:"h3",onPaste:this.handlePasteAsPlainText}),l.a.createElement("button",{className:"button-close",onClick:this.props.onRequestClose},l.a.createElement("i",{className:"fas fa-times"}))),l.a.createElement("div",{className:"columns"},l.a.createElement("section",{className:"column-main"},l.a.createElement("h4",null,"Progress"),this.renderProgress(),D(t)&&this.renderDaily()),l.a.createElement("aside",{className:"column-aside"},O(t)?l.a.createElement(l.a.Fragment,null,l.a.createElement("button",{className:"button-side",onClick:function(){return e.props.onToggleComplete(t)}},"Mark as ",t.completed?"incomplete":"complete"),l.a.createElement("button",{className:"button-side",onClick:function(){return e.props.onToggleDaily(t)}},D(t)?"Convert to regular":"Convert to daily")):l.a.createElement("button",{className:"button-side",onClick:this.handleViewChildren},"View children"),l.a.createElement("button",{className:"button-side",onClick:function(){return e.props.onDelete(t,e.props.onRequestClose)}},"Delete goal")))):null}}]),t}(o.Component);var _e=Object(u.b)(function(e,t){return{subgoal:m(q(e),t.subgoalId)}},function(e){return{onChangeTitle:function(t,n){return e(Y(t.id,n))},onToggleComplete:function(t){return e(U(t.id))},onViewChildren:function(t){return e(ee(t.id))},onDelete:function(t,n){return function(e,t,n){var a=t.id;e(Ee("Are you sure you want to delete this goal? This action cannot be undone",function(){e(K(a)),n()},function(){}))}(e,t,n)},onMarkDay:function(t,n){return function(e,t,n){var a=new Date;n.getFullYear()===a.getFullYear()&&n.getMonth()===a.getMonth()&&n.getDate()===a.getDate()?e(V(t.id,a.toISOString())):e(V(t.id,n.toISOString()))}(e,t,n)},onUnmarkDay:function(t,n){return function(e,t,n){e(W(t.id,n.toISOString()))}(e,t,n)},onChangeDailyType:function(t,n){return e((a=t.id,{type:R,goalId:a,newType:n}));var a},onConfigureDailyType:function(t,n){return e(function(e,t){return{type:_,goalId:e,config:t}}(t.id,n))},onToggleDaily:function(t){return e((n=t.id,{type:L,goalId:n}));var n}}})(Re),Le=(n(213),function(e){var t=e.hasChildren,n=e.isComplete,a=e.isExpanded,o=e.isDaily,r=e.onToggleExpanded,i=e.onClick,s=e.onComplete,c=e.onOpenMenu,u=e.depth,d=e.children,m=l.a.createRef();return l.a.createElement("div",{className:"subgoal-list-item depth-".concat(u," ").concat(n?"complete":"")},l.a.createElement("button",{href:"#",className:"button-complete",onClick:s,disabled:t},l.a.createElement("i",{className:"fas fa-check"})),l.a.createElement("div",{className:"subgoal-list-item-text",onClick:i},d),t&&l.a.createElement("div",{className:"toggle-expand",onClick:r},l.a.createElement("i",{className:"fas fa-chevron-"+(a?"up":"down")})),o&&l.a.createElement("span",{className:"daily-indicator"},l.a.createElement("i",{className:"fas fa-calendar"})),l.a.createElement("button",{href:"#",className:"button-overflow",onClick:function(){return c(m)}},l.a.createElement("i",{ref:m,className:"fas fa-ellipsis-v"})))}),Pe=(n(215),function(e){function t(e){var n;return Object(te.a)(this,t),(n=Object(ae.a)(this,Object(oe.a)(t).call(this,e))).getTreeData=n.getTreeData.bind(Object(Se.a)(Object(Se.a)(n))),n.renderItem=n.renderItem.bind(Object(Se.a)(Object(Se.a)(n))),n.convertGoalToTreeItem=n.convertGoalToTreeItem.bind(Object(Se.a)(Object(Se.a)(n))),n.handleOpenMenu=n.handleOpenMenu.bind(Object(Se.a)(Object(Se.a)(n))),n.handleCloseMenu=n.handleCloseMenu.bind(Object(Se.a)(Object(Se.a)(n))),n.handleExpand=n.handleExpand.bind(Object(Se.a)(Object(Se.a)(n))),n.handleCollapse=n.handleCollapse.bind(Object(Se.a)(Object(Se.a)(n))),n.handleDragEnd=n.handleDragEnd.bind(Object(Se.a)(Object(Se.a)(n))),n.openSubgoalDialog=n.openSubgoalDialog.bind(Object(Se.a)(Object(Se.a)(n))),n.closeSubgoalDialog=n.closeSubgoalDialog.bind(Object(Se.a)(Object(Se.a)(n))),n.state={menu:{open:!1,anchorRef:null,items:[]},modal:{open:!1,subgoal:null},collapsedGoals:{}},n}return Object(le.a)(t,e),Object(ne.a)(t,[{key:"convertGoalToTreeItem",value:function(e){return{id:e.id,children:e.subgoals.map(function(e){return e.id}),hasChildren:e.subgoals.length>0,isExpanded:!(e.id in this.state.collapsedGoals),isChildrenLoading:!1,data:{goal:e}}}},{key:"getTreeData",value:function(){var e=p(this.props.goal.subgoals).map(this.convertGoalToTreeItem);return e.push(this.convertGoalToTreeItem(this.props.goal)),{rootId:this.props.goal.id,items:e.reduce(function(e,t){return e[t.id]=t,e},{})}}},{key:"handleCollapse",value:function(e){this.setState(function(t){var n=Object(z.a)({},t);return n.collapsedGoals[e]=!0,n})}},{key:"handleExpand",value:function(e){this.setState(function(t){var n=Object(z.a)({},t);return e in n.collapsedGoals&&delete n.collapsedGoals[e],n})}},{key:"handleOpenMenu",value:function(e,t){var n=this;this.setState(function(a){var o=Object(z.a)({},a);return o.menu={open:!0,anchorRef:t,items:[{text:"Edit subgoal",onClick:function(){n.openSubgoalDialog(e.id)}},{text:"Delete subgoal",onClick:function(){n.props.onDeleteGoal(e.id)}}]},o})}},{key:"handleCloseMenu",value:function(){this.setState(function(e){var t=Object(z.a)({},e);return t.menu={open:!1,anchorRef:null,items:[]},t})}},{key:"handleDragEnd",value:function(e,t){if(t){var n=m([this.props.goal],t.parentId);if(null!==n)D(n)?this.props.onErrorNotification("Daily goals cannot have subgoals"):this.props.onDragEnd(e,t)}}},{key:"openSubgoalDialog",value:function(e){this.setState(function(t){var n=Object(z.a)({},t);return n.modal.open=!0,n.modal.subgoalId=e,n})}},{key:"closeSubgoalDialog",value:function(){this.setState(function(e){var t=Object(z.a)({},e);return t.modal.open=!1,setTimeout(function(){t.modal.subgoal=null},200),t})}},{key:"renderItem",value:function(e){var t=this,n=e.item,a=e.depth,o=e.onExpand,r=e.onCollapse,i=e.provided,s=(e.snapshot,n.data.goal);return l.a.createElement("span",Object.assign({ref:i.innerRef},i.draggableProps,i.dragHandleProps,{style:i.draggableProps.style}),l.a.createElement(Le,{hasChildren:n.hasChildren,isComplete:k(s),isExpanded:n.isExpanded,isDaily:D(s),onToggleExpanded:function(){return n.isExpanded?r(n.id):o(n.id)},onClick:function(){return t.openSubgoalDialog(s.id)},onComplete:function(){return t.props.onCompleteGoal(s.id)},onOpenMenu:function(e){return t.handleOpenMenu(s,e)},depth:a},s.name))}},{key:"render",value:function(){var e=this,t=this.getTreeData();return l.a.createElement("div",{className:"subgoal-list"},l.a.createElement(Te.a,{tree:t,renderItem:this.renderItem,onExpand:this.handleExpand,onCollapse:this.handleCollapse,onDragEnd:this.handleDragEnd,offsetPerLevel:0,isDragEnabled:!0,isNestingEnabled:!0}),l.a.createElement(Fe,{onAddKeyPress:function(t){return e.props.onAddKeyPress(t,e.props.goal.id)},depth:this.props.newSubgoalDepth}),l.a.createElement(xe,{visible:this.state.menu.open,items:this.state.menu.items,anchorRef:this.state.menu.anchorRef,onCloseMenu:this.handleCloseMenu}),l.a.createElement(c.a,{isOpen:this.state.modal.open,contentLabel:"Edit subgoal",onRequestClose:this.closeSubgoalDialog,overlayClassName:"modal-overlay",className:"subgoal-modal",closeTimeoutMS:200},l.a.createElement(_e,{subgoalId:this.state.modal.subgoalId,onRequestClose:this.closeSubgoalDialog})))}}]),t}(o.Component)),Fe=function(e){var t=e.onAddKeyPress,n=e.depth;return l.a.createElement("div",{className:"subgoal-list-item subgoal-list-add depth-".concat(n)},l.a.createElement("div",{className:"subgoal-list-item-text",placeholder:"Type here",contentEditable:"true",onKeyDown:t}),l.a.createElement("i",{className:"fas fa-plus button-add"}))},Be=Pe,Ye="subgoals/notifications/SHOW_NOTIFICATION",Ue="subgoals/notifications/DISMISS_NOTIFICATION",Ke={notifications:[]};function Ve(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ke,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case Ye:var n=Object(J.a)(e.notifications);return n.push({message:t.message,key:t.key,action:t.action,dismissAfter:t.dismissAfter}),Object(z.a)({},e,{notifications:n});case Ue:var a=Object(J.a)(e.notifications),o=a.findIndex(function(e){return e.key===t.key});return o>-1&&a.splice(o,1),Object(z.a)({},e,{notifications:a});default:return e}}function We(e,t,n){"Enter"!==t.key||t.shiftKey||(e(function(e,t){return{type:N,name:e,goalId:t}}(t.target.textContent,n)),t.preventDefault(),t.target.textContent="")}function qe(e,t,n){e(function(e,t){return{type:I,src:e,dst:t}}(t,n))}var He=Object(u.b)(function(e){return{newSubgoalDepth:e.page.newSubgoalDepth}},function(e){return{onAddKeyPress:function(t,n){return We(e,t,n)},onDragEnd:function(t,n){return qe(e,t,n)},onDeleteGoal:function(t){return function(e,t){e(Ee("Are you sure you want to delete this goal? This action cannot be undone",function(){e(K(t))},function(){}))}(e,t)},onCompleteGoal:function(t){return e(U(t))},onErrorNotification:function(t){return e(function(e,t,n,a){return{type:Ye,message:t,key:e,action:n,dismissAfter:a}}((new Date).getTime(),t,"Dismiss",5e3))}}})(Be),Je=function(e){function t(){return Object(te.a)(this,t),Object(ae.a)(this,Object(oe.a)(t).apply(this,arguments))}return Object(le.a)(t,e),Object(ne.a)(t,[{key:"render",value:function(){var e=this.props.goal;return l.a.createElement(He,{goal:e})}}]),t}(o.Component),ze=(n(256),function(e){var t=e.title,n=e.color,a=e.hasBack,o=e.onGoBack;return l.a.createElement("header",{className:"nav-bar bg-".concat(n)},l.a.createElement("div",{className:"page-width page-margins"},a?l.a.createElement("button",{href:"#",className:"back-button",onClick:o},l.a.createElement("i",{className:"fas fa-arrow-left"})):"",l.a.createElement("h1",null,t)))}),Qe=(n(258),n(260),function(e){var t=e.isOpen,n=e.onClose,a=e.children;return l.a.createElement(c.a,{isOpen:t,contentLabel:"Dialog",onRequestClose:n,overlayClassName:"dialog-overlay",className:"dialog",closeTimeoutMS:200},a)}),Xe=function(e){return l.a.createElement(Qe,e,l.a.createElement("header",null,l.a.createElement("h3",null,"Information"),l.a.createElement("button",{onClick:e.onClose},l.a.createElement("i",{className:"fas fa-times"}))),l.a.createElement("section",null,e.text))},Ze=n(45),$e=(n(262),function(e){e.text;var t=Object(Ze.a)(e,["text"]);return l.a.createElement(Qe,t,l.a.createElement("header",null,l.a.createElement("h3",null,"Are you sure?"),l.a.createElement("button",{onClick:e.onClose},l.a.createElement("i",{className:"fas fa-times"}))),l.a.createElement("section",null,l.a.createElement("p",null,e.text),l.a.createElement("div",{className:"buttons"},l.a.createElement("button",{className:"button button--primary",onClick:function(){e.onClose(),e.onAccept()}},"Yes"),l.a.createElement("button",{className:"button",onClick:function(){e.onClose(),e.onReject()}},"No"))))}),et=(n(264),function(e){function t(e){var n;return Object(te.a)(this,t),(n=Object(ae.a)(this,Object(oe.a)(t).call(this,e))).handleChangeInput=n.handleChangeInput.bind(Object(Se.a)(Object(Se.a)(n))),n.handleSubmit=n.handleSubmit.bind(Object(Se.a)(Object(Se.a)(n))),n.state={value:e.value},n}return Object(le.a)(t,e),Object(ne.a)(t,[{key:"handleSubmit",value:function(e){e.preventDefault(),this.props.onClose(),this.props.onAccept(this.state.value)}},{key:"handleChangeInput",value:function(e){this.setState({value:e.target.value})}},{key:"componentWillReceiveProps",value:function(e){this.props.value!==e.value&&this.setState({value:e.value})}},{key:"render",value:function(){var e=this,t=this.props,n=(t.text,Object(Ze.a)(t,["text"]));return l.a.createElement(Qe,n,l.a.createElement("header",null,l.a.createElement("h3",null,this.props.text),l.a.createElement("button",{onClick:this.props.onClose},l.a.createElement("i",{className:"fas fa-times"}))),l.a.createElement("section",null,l.a.createElement("form",{action:"",onSubmit:this.handleSubmit},l.a.createElement("p",null,l.a.createElement("input",{type:"text",className:"large-input",onChange:this.handleChangeInput,value:this.state.value,autoFocus:!0})),l.a.createElement("div",{className:"buttons"},l.a.createElement("button",{className:"button button--primary",type:"submit"},"OK"),l.a.createElement("button",{className:"button",type:"button",onClick:function(){e.props.onClose(),e.props.onReject()}},"Cancel")))))}}]),t}(o.Component)),tt=(n(266),function(e){function t(e){var n;return Object(te.a)(this,t),(n=Object(ae.a)(this,Object(oe.a)(t).call(this,e))).renderColorButtons=n.renderColorButtons.bind(Object(Se.a)(Object(Se.a)(n))),n.state=n.generateInitialState(e),n}return Object(le.a)(t,e),Object(ne.a)(t,[{key:"generateInitialState",value:function(e){return{selected:e.value||"color-0"}}},{key:"componentWillReceiveProps",value:function(e){!this.props.isOpen&&e.isOpen&&this.setState(this.generateInitialState(e))}},{key:"handleChangeSelected",value:function(e){this.setState({selected:e})}},{key:"renderColorButtons",value:function(){for(var e=this,t=[],n=function(n){var a="color-".concat(n)===e.state.selected?"selected":"";t.push(l.a.createElement("button",{key:n,className:"color-button bg-color-".concat(n," ").concat(a),onClick:function(){return e.handleChangeSelected("color-".concat(n))}},l.a.createElement("i",{className:"fas fa-check"})))},a=0;a<32;a++)n(a);return t}},{key:"render",value:function(){var e=this;return l.a.createElement(Qe,this.props,l.a.createElement("header",null,l.a.createElement("h3",null,"Choose colour"),l.a.createElement("button",{onClick:this.props.onClose},l.a.createElement("i",{className:"fas fa-times"}))),l.a.createElement("section",null,l.a.createElement("div",{className:"color-picker"},this.renderColorButtons()),l.a.createElement("div",{className:"buttons"},l.a.createElement("button",{className:"button button--primary",onClick:function(){e.props.onClose(),e.props.onAccept(e.state.selected)}},"OK"),l.a.createElement("button",{className:"button",onClick:function(){e.props.onClose(),e.props.onReject()}},"Cancel"))))}}]),t}(o.Component)),nt=Object(u.b)(function(e){return{type:e.dialog.type,text:e.dialog.message,isOpen:e.dialog.isOpen,onAccept:e.dialog.onAccept,onReject:e.dialog.onReject,value:e.dialog.value}},function(e){return{onClose:function(){return e({type:pe})}}})(function(e){return e.type===be?l.a.createElement($e,e):e.type===ge?l.a.createElement(Xe,e):e.type===fe?l.a.createElement(et,e):e.type===he?l.a.createElement(tt,e):null}),at=n(105),ot=Object(u.b)(function(e,t){return{notifications:e.notifications.notifications}},function(e){return{onDismiss:function(t){var n;e((n=t.key,{type:Ue,key:n}))}}},function(e,t,n){return Object(z.a)({},e,t,n,{notifications:e.notifications.map(function(e){return Object(z.a)({},e,{onClick:function(e,n){n(),t.onDismiss(e)}})})})})(at.NotificationStack),lt=function(e){var t=e.title,n=e.selectedGoal,a=e.hasBack,o=e.onGoBack,r=null!=n?n.color||C(n):"primary";return l.a.createElement("div",{id:"main"},l.a.createElement(ze,{title:t,hasBack:a,onGoBack:o,color:r}),l.a.createElement("section",{id:"body",className:"page-width page-margins"},null==n?l.a.createElement(Ie,null):l.a.createElement(Je,{goal:n})),l.a.createElement(nt,null),l.a.createElement(ot,null))},rt=Object(u.b)(function(e){var t=m(q(e),e.page.selectedGoalId);return{selectedGoal:t,title:null===e.page.selectedGoalId?"Subgoals":t.name,hasBack:e.page.history.length>0}},function(e){return{onGoBack:function(){return e({type:X})}}})(lt),it=n(12),st=n(65),ct=Object(it.c)(a),ut=Object(it.a)(Object(st.save)(["goals","page"]))(it.e)(ct,Object(st.load)());i.a.render(l.a.createElement(u.a,{store:ut},l.a.createElement(rt,null)),document.getElementById("root")),c.a.setAppElement("#main")}},[[106,2,1]]]);
//# sourceMappingURL=main.22fca14c.chunk.js.map